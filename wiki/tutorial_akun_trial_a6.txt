# TRIAL A6

Ini adalah panduan *all-in-one* untuk masa uji coba user dengan **kode [A]/6**.

## Login ALELEON Supercomputer

**- Langkah Login ke ALELEON Supercomputer -**

**1. Aktifkan [Koneksi VPN ALELEON Supercomputer]**

**2. Pilih opsi login:**
*(User dapat login keduanya di waktu bersamaan)*

* **Login SSH Terminal**
Lakukan SSH dengan software shell preferensi user:
* **Username dan password:** *Diberikan admin EFISON*
* **Host untuk user Windows / MacOS:** `aleleon.hpc`
* **Host untuk user Linux:** `10.192.50.10`
* **Nomor port:** `22` *(default)*


*Contoh login via terminal:*
* User Windows & MacOS -> `$ ssh [username]@aleleon.hpc`
* User Linux -> `$ ssh [username]@10.192.50.10`


* **Login Portal Web EFIRO**
Buka portal web EFIRO. Login dengan username dan password user.
* Web EFIRO user Windows / MacOS -> **[[http://aleleon.ood](https://www.google.com/search?q=http://aleleon.ood)]**
* Web EFIRO user Linux -> **[[http://10.192.50.11](http://10.192.50.11)]**



---

## Spesifikasi Trial dan Reproduksi Langkah

Masa uji coba ini menjalankan komputasi Python dengan spesifikasi:

1. Menggunakan **conda environment** untuk menampung instalasi package Python dan isolasi site-packages (tempat instalasi package Python).
2. Dapat dijalankan secara *batch job* dan sesi *Jupyter* ALELEON Supercomputer.

### Conda Environment 'tensor'

**Tim admin menyediakan conda environment siap pakai pada akun uji coba bernama 'tensor' dengan spesifikasi:**

1. Dibuat dengan Anaconda 3 2024-02.1 dan Python 3.11.
2. Package utama TensorFlow 2.19 versi CUDA + CUDA 12.5.

**Tutorial ini memberikan info bagaimana tim admin membuat conda env 'tensor' dan menjalankannya di akun masa uji coba:**

* Supaya user dapat melakukan hal serupa apabila membutuhkan membuat conda env lain,
* Contohnya untuk instalasi package yang tidak dapat disatukan bersama TensorFlow karena ketidakcocokan *dependencies* seperti PyTorch.

---

## Langkah Menjalankan Komputasi

Terdapat tiga langkah utama:

1. Buat conda environment untuk menampung instalasi package.
2. Instal package Python yang diperlukan di conda env tersebut.
3. Menggunakan conda env tersebut untuk menjalankan komputasi.

### Spesifikasi

Tutorial ini memandu membuat conda environment dengan **site-packages terisolasi di dalamnya**.

| Keterangan simbol perintah terminal |  |
| --- | --- |
| **`$`** | Perintah ketika conda env tidak aktif |
| **`(env)$`** | Perintah ketika conda env aktif |

---

## Membuat Conda Environment

Tutorial ini menggunakan **Anaconda 3** terbaru di ALELEON yaitu versi **2024-02.1** dengan environment **Python 3.11** karena saat ini (dianggap) cocok untuk instalasi semua jenis package.

***Menggunakan terminal!*** *(User EFIRO klik app `Aleleon Shell Access` atau menu `Apps > Aleleon Shell Access`)*

**1. Aktifkan modul Anaconda 3 2024.02-1**

```bash
$ module load Anaconda3/2024.02-1

```

**2. Buat conda env kosong dengan Python 3.11:**

```bash
$ conda create -n [nama-conda-env] python=3.11

# Contoh pada conda env "tensor":
$ conda create -n tensor python=3.11

```

---

## Mengaktifkan Conda Env dan Instalasi Package

⚠️ Ada baiknya user melengkapi instalasi package **sebelum menjalankan komputasi** karena:

1. Batch job -> supaya script Python berjalan tanpa error *missing package*.
2. Sesi Jupyter -> untuk efisiensi penggunaan karena terkadang ada package yang membutuhkan waktu lama untuk instalasi.

*Instalasi ini berjalan di login node sehingga tidak mengkonsumsi Core Hour.*

**1. Muat atau pastikan modul Anaconda 3 2024.02-1 aktif:**

```bash
$ module load Anaconda3/2024.02-1

```

**2. Aktifkan conda env dengan perintah `source`:**

```bash
$ source activate [nama-conda-env]

# contoh pada conda env tensor:
$ source activate tensor

```

*(Apabila lupa dengan nama conda env, cari dengan perintah `$ conda env list`)*

**3A. Pilih panduan instalasi package yang dibutuhkan**
Lihat laman [Daftar Instalasi Package Python]. *(Pada conda env tensor lihat subbab TensorFlow).*

**3B. Untuk user yang hendak menggunakan sesi Jupyter**
Instal package jupyter:

```bash
(env)$ pip install jupyter jupyterlab

```

**4. Apabila hendak menonaktifkan conda env:**

```bash
(env)$ conda deactivate

```

---

## Pilihan Menjalankan Komputasi

Berikut opsi menjalankan komputasi Python dengan conda env, pilih sesuai kebutuhan:

### 1. Batch Job

* **Berjalan di [Compute node]:** Partisi epyc (CPU) atau Partisi ampere (GPU).
* **Fungsi:** Menjalankan script Python siap jalan yang tidak membutuhkan interaksi user.
* ⚠️ Perhatikan file `.ipynb` harus dikonversi ke file `.py`.
* *Koneksi user tidak mempengaruhi jalannya batch job. Job tidak akan berhenti ketika koneksi user terputus atau log out.*

### 2. Sesi Jupyter

* **Berjalan di [Interactive node]:** Partisi torti (CPU) atau Partisi tilla (GPU).
* **Fungsi:** Menjalankan sesi interaktif Jupyter Lab atau Notebook.
* *Sesi tidak akan berhenti walau koneksi terputus. Jika keluar saat ada cell berjalan dan kembali masuk, lihat cell berikutnya untuk memastikan proses.*

---

### Menjalankan Package Python versi GPU?

Perhatikan hal berikut apabila user menginstal **package Python versi CUDA** dan hendak menggunakan node GPU:

1. Package membutuhkan library NVIDIA (CUDA, cuDNN) untuk berjalan di GPU.
2. Cek ketersediaan library CUDA di conda env Anda dengan mengaktifkan env dan menjalankan:
```bash
(env)$ pip list | grep cuda
# atau
(env)$ conda list | grep cuda

```


3. **Apabila ada output:** Conda env siap digunakan, user *tidak perlu* memuat modul CUDA.
4. ⚠️ **Apabila tidak ada output:** User *harus memuat modul CUDA*.
*(Contoh modul CUDA yang tersedia: `cuda/11.8-cuDNN8.6.0`, `cuda/12.5-cuDNN9.2.1`, dll).*
* Untuk Batch Job: tambahkan `module load [Nama-modul-CUDA]` di submit script.
* Untuk Sesi Jupyter: Isi nama modul pada form *Software Modules*.



---

### Langkah Batch Job di Terminal

**1. Lakukan persiapan:**
Pastikan package lengkap, siapkan file komputasi `.py`.
⚠️ Cegah job mengacu env yang salah dengan keluar dari env dan unload modul:

```bash
(env)$ conda deactivate
$ ml unload Anaconda3

```

**2. Buat Submit Script (`.sh`):**

```bash
$ nano submit.sh

```

**Contoh Template (CPU):**

```bash
#!/bin/bash
#SBATCH --ntasks=////       # Alokasi jumlah core thread CPU (Range 2 - 16)
#SBATCH --mem=////GB        # Alokasi RAM GB (Range 1 - 64)
#SBATCH --time=////         # Limit waktu HH:MM:SS (Maks 24:00:00)
#SBATCH --output=result-%j.txt
#SBATCH --error=error-%j.txt

PM="Anaconda3/2024.02-1"
CONDA_NAME="tensor"         # Ganti dengan nama conda env Anda

module load ${PM}
source activate ${CONDA_NAME}

# Perintah Python Anda
python3 nama-file-python.py

```

*(Untuk GPU: Tambahkan `#SBATCH --partition=ampere` dan `#SBATCH --gpus=1`)*

**3. Jalankan dan Pantau Job:**

* Submit: `$ sbatch submit.sh`
* Status Job: `$ squeue -ul $USER` (R=Run, PD=Pending, CG=Completing)
* Pantau Core Hour: `$ sausage`
* Batalkan Job: `$ scancel [job-ID]`

> ⚠️ Akun uji coba memiliki limit maksimal 1 *concurrent job* (Hanya 1 job berjalan pada 1 waktu). Limit lain: 16 Core CPU, 1 GPU, 64GB RAM, Walltime 24 jam.

---

### Langkah Batch Job di Web EFIRO

1. **Login** ke web EFIRO ALELEON Supercomputer.
2. Buka aplikasi **`Job Composer`**.
3. Klik **`New Job > From Template`**, pilih template `TRIAL [A]/6 - Conda Env (CPU)` atau `(GPU)`, lalu klik **Create New Job**.
4. Gunakan opsi **`Edit Files`** untuk melengkapi file komputasi `.py`.
5. Klik **`Open Editor`** untuk menyesuaikan variabel di Submit Script (`ntasks`, `mem`, `time`, `CONDA_NAME`), lalu klik **Save**.
6. Klik **`Submit`** untuk menjalankan.
7. Cek status di dashboard (Queue, Running, Completed, Failed).

---

### Langkah Sesi Jupyter

1. **Login** ke web EFIRO ALELEON Supercomputer.
2. Pastikan file dan package sudah disiapkan sebelumnya untuk menghemat Core Hour.
3. Klik aplikasi **`Jupyter`**.
4. Isi formulir parameter sesi:
* **Jupyter version:** `Jupyter Lab` atau `Notebook`
* **Partition:** `torti` (CPU) atau `tilla` (GPU)
* **Number of CPU / RAM / GPUs:** Sesuai kebutuhan limit (Maks 16 CPU, 55GB RAM, 1 GPU).
* **Number of hours:** Sesuai kebutuhan (Maks 24 jam)
* **Launch method:** `Anaconda/Mamba`
* **Anaconda/Mamba version:** `Anaconda 3 2024.02-1`
* **Conda/Mamba environment directory:** `tensor` (atau nama env yang Anda buat)


5. Klik **`Launch`**.
6. Saat status *Running*, klik **`Connect to Jupyter`** (Perhitungan Core Hour dimulai).
7. Gunakan kernel **Python 3 (ipykernel)** untuk eksekusi file.
8. Gunakan perintah terminal `$ sausage` untuk memantau sisa kuota (CCH/GH).

---

## Pelaporan Kendala dan Support

Apabila menjumpai masalah teknis dalam menjalankan komputasi, Anda dapat melapor melalui layanan *Bug Report* di portal utama EFISON atau menghubungi admin EFISON melalui email:
**`support@efisonlt.com`**